#!/usr/bin/env bash

secure() {
  local arg

  for arg; do
    if [ -d "$arg" ]; then
      chmod 700 "$arg"
    elif [ -f "$arg" ]; then
      chmod 600 "$arg"
    fi
  done
}

pull_or_update() {
  local repo=$1
  local destination=$2

  if [ ! -d "$destination" ]; then
    mkdir -p "$(dirname $destination)"
    git clone https://github.com/"$repo" "$destination"
  else
    git -C "$destination" pull
  fi
}

# Antigen. Zsh package maneger
pull_or_update "zsh-users/antigen" "$HOME/.config/zsh/antigen"

# Ruby Env
RBENV="$HOME/.rbenv"
pull_or_update "rbenv/rbenv" "$RBENV"
(cd "$RBENV" && src/configure && make -C src) || true

secure ~/.msmtprc ~/.config/gnupg

[ -d ~/.mutt ] && mkdir -p ~/.mutt/temp
